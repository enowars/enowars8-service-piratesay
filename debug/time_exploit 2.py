import random
import socket
import string
import time

# Telnet server details
host = 'localhost'
port = 4444

# Establish a connection
with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.connect((host, port))

    # Function to receive data until a certain prompt is found
    def recv_until_prompt(prompt):
        data = b''
        while not data.endswith(prompt):
            data += s.recv(1024)
        return data
    
    # At time of creation, assume that the user we want to exploit was created in the last second

    # Get int that equals time(NULL) in c
    time_int = int(time.time())

    IDENTITY_LENGTH = 64
    seed = 1720539096  # Example seed value, replace with your input

    # Constants for the LCG (these are typical values used by the glibc implementation)
    RAND_MAX = 2**31 - 1
    a = 1103515245
    c = 12345
    m = 2**31

    def lcg_rand(seed):
        while True:
            seed = (a * seed + c) % m
            yield (seed // 65536) % 32768  # Mimics the behavior of glibc rand()

    lcg = lcg_rand(seed)

    identity_string = ''.join(chr(ord('a') + (next(lcg) % 26)) for _ in range(IDENTITY_LENGTH))

    print(f"Generated identity string: {identity_string}")



